language: node_js
node_js:
- 0.10

before_install:
- git config --global user.name "Green Lei"
- git config --global user.email "leiguorui@goodow.com"
- cd gh-pages && git pull origin gh-pages && git remote set-url origin "https://${GH_TOKEN}@github.com/leiguorui/drive-web-svg.git"
- cd ${TRAVIS_BUILD_DIR}

before_script:
- npm install -g bower
- npm install gulp-cssmin
script:
- bower install
- gulp

after_success:
- cd gh-pages
- rm -rf `find . -maxdepth 1 -name "*" ! -name ".git*" ! -name "CNAME"`
- cp -r ../bower_components/ ../index.html ../bower-drive-web-svg/ ./
- git add . && git commit -a -m "Generated by leiguorui/drive-web-svg@${TRAVIS_COMMIT}"
- test ${TRAVIS_PULL_REQUEST} == "false" && git push -f origin HEAD:gh-pages
- cd ${TRAVIS_BUILD_DIR}

env:
  global:
    secure: yA1Cpck8+5l2NC2HCtyt98TgeqVR9tAe5z7OcTaHWHNluslBkGlivNxcyvv7RI/8ctzWtWGGSSr6ofvm+MmZFFeDCHZhz8B2LfheT3Gni3kt4ZstRdEYTDjtpSFMpnubxU36/8RC8W1UjFfHO8SA7NxlEvzbD8160/zU8vi4bls=